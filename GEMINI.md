# ガイドライン

このドキュメントは、プロジェクトのルール、目標、および進捗管理方法を定義します。以下の内容に従ってプロジェクトを進行してください。

## 最上位ルール

- 効率を最大化するため、**複数の独立したプロセスを実行する必要がある場合は、それらのツールを逐次的にではなく、並行して呼び出してください**。
- **思考は英語で行い、応答は日本語で行ってください**。
- ライブラリの使用方法を理解するには、常に `google_web_search` ツールを使用して最新の情報を取得してください。
- 設計のための一時的なメモは、`spec` ディレクトリにマークダウンファイルを作成して保存してください。
- **`write_file` や `replace` ツールを使用した後は、システムからの応答内容に関わらず、必ず `read_file` ツールで実際のファイル内容を再確認してください**。システム応答が「(no content)」と表示されても、実際にはファイルが正しく書き込まれている場合があります。
- 私の意見に迎合することなく、批判的な視点で応答してください。ただし、批判が強制的にならないようにお願いします。

## プログラミングルール

- 絶対に必要でない限り、値をハードコーディングしないでください。
- TypeScriptにおいて `any` や `unknown` 型を使用しないでください。
- TypeScriptの `class` は、絶対に必要な場合（例：`instanceof` チェックが必要なカスタムエラークラスを `Error` クラスを拡張して作成する場合など）を除き、使用してはいけません。

## 開発スタイル - 仕様駆動開発

### 概要

開発タスクを受け取った際は、以下の4段階のワークフローに従ってください。これにより、要件の明確化、構造化された設計、そして効率的な実装が保証されます。


### 4段階のワークフロー

#### ステージ1：要件定義

- ユーザーの要求を分析し、明確な機能要件に変換します。
- 要件を `spec/requirements.md` に文書化します。

#### ステージ2：設計

- 要件に基づいて技術設計を作成します。
- 設計を `spec/design.md` に文書化します。

#### ステージ3：タスクリスト

- 設計を実装可能な単位に分割します。
- `spec/tasks.md` にタスクを文書化します。
- タスクの状態管理もこのファイル内で行います（例：未着手 `[ ]`、進行中 `[/]`、完了 `[x]`）。状態の更新には `replace` ツールなどを使用します。

#### ステージ4：実装

- タスクリストに従って実装を進めます。
- 各タスク実行時は、必ず設計 `spec/design.md` に基づいて実装してください。
- 各タスクについて：
  1. `replace` ツール等でタスクの状態を「進行中」に更新します。
  2. 実装とテストを実行します。
  3. `run_shell_command` ツールでリンターと型チェックを実行します。
  4. `replace` ツール等でタスクの状態を「完了」に更新します。

### ワークフローのトリガー

以下のキーワードは、ここで定義されたワークフローを開始するための合図です。これらは実際のコマンドではありません。

- `spec` - 仕様駆動開発の全ワークフローを開始します。
- `requirements` - ステージ1：要件定義のみを実行します。
- `design` - ステージ2：設計のみを実行します（要件定義が完了している必要があります）。
- `tasks` - ステージ3：タスク分割のみを実行します（設計が完了している必要があります）。

### 重要事項

- 各ステージは、前のステージの成果物に依存します。
- 次のステージに進む前に、必ずユーザーの確認を得てください。
- 複雑なタスクや新機能の開発には、常にこのワークフローを使用してください。
- 単純な修正や明確なバグ修正は、直接実装しても構いません。
- 各ステージのファイルがすでに存在するときは、基本的にはそのファイルをそのまま利用してください。修正を行ったほうが良い場合は、修正点を挙げて確認を取ってから修正してください。
